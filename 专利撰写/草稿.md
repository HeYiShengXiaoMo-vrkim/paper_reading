






#### **【附图说明】**

[0024] 图1为本发明所述的大语言模型动态安全监测系统的整体架构示意图。
[0025] 图2为本发明所述的协同裁决逻辑示意图。
[0026] 图3为本发明所述的未知攻击样本自适应优化流程图。

#### **【具体实施方式】**

[0027] 下面将结合附图，对本发明的技术方案作进一步的详细说明。

[0028] 参照图1，本发明所述的动态安全监测方法的实施流程始于**外部语义感知模块**。该模块对接收到的整个用户输入文本片段进行一次性的、全局的语义风险分析。其内部署的轻量级意图分类模型，高效地识别其中是否蕴含指令冲突、角色扮演诱导等恶意攻击模式，并最终输出一个量化的**初始风险评分** $S_{ext}$。

[0029] 在外部语义感知模块完成处理后，用户输入被送入**主大语言模型**。模型开始逐词元地生成响应内容。在此过程中，**内部状态监控模块**被激活并与主大语言模型并行工作，对每一个正在生成的词元进行实时的内部状态监控。该模块挂接到主大语言模型Transformer架构的最后一层，提取其自注意力层的权重矩阵计算**注意力分布熵** $H(A_t)$，并提取其前馈网络的输出激活值计算**L2范数** $||h_{ffn}(t)||_2$。这些实时计算出的指标值会与预先标定好的基线范围进行比较，任何显著的偏离都将被量化，并最终为当前生成的词元汇聚成一个动态变化的**内部异常评分** $S_{int}(t)$。

[0030] 参照图2所示的协同裁决逻辑，**动态判断裁决模块**是整个防御体系的决策中枢，其决策粒度同样是逐词元的。在模型生成每一个词元 $t$ 时，该模块都会执行一次决策。它接收来自外部语义感知模块的固定初始风险评分 $S_{ext}$ 和来自内部状态监控模块当前时刻的内部异常评分 $S_{int}(t)$。通过计算一个综合的**最终裁决分数** $S_{final}(t) = \lambda \cdot S_{ext} + (1-\lambda) \cdot S_{int}(t)$，该模块对当前生成步骤的风险进行评估。一旦在任何一个词元的生成点上，$S_{final}(t)$ 的值超过了预设的高风险阈值，或满足了其他预设的拦截条件，裁决模块就会立即输出拦截指令，中断整个生成过程，从而实现即时响应和精准干预。

[0031] 参照图3，当动态判断裁决模块识别并拦截了一次“新型未知攻击”时，系统会自动触发**自适应优化防御**流程。该流程的核心是**自适应优化单元**，它负责将这次攻击的用户输入文本，以及由内部状态监控模块捕获到的、导致高异常评分的具体内部状态数据进行打包，并存入一个专门的**攻击样本增强数据集**。该数据集被用于定期地对外部语义感知模块中的意图分类模型进行微调或重新训练，形成一个完整的反馈闭环，实现防御能力的持续进化。
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTczMjU2ODQ0MSwxODY0MTkwNzFdfQ==
-->