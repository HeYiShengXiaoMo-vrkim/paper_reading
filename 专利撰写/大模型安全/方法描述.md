### **一种基于内部状态与外部语义协同感知的大语言模型动态安全防御系统及方法**

#### **要解决的技术问题**

现有的大语言模型安全防御技术，特别是针对提示注入和越狱攻击的方案，存在以下核心缺陷：

1.  **表层防御，易于绕过**：传统输入/输出过滤器依赖静态规则或关键词，攻击者可通过同义词替换、复杂叙事、编码等手段轻易绕过，防御能力薄弱。
    
2.  **黑箱检测，无法感知内部状态**：现有技术将大语言模型视为一个“黑箱”，仅在外部进行文本审查，无法感知模型在处理恶意输入时其内部计算状态发生的关键变化，导致对语义隐晦的攻击束手无策。
    
3.  **泛化能力差，难以应对未知攻击**：由于依赖已知的攻击模式，现有防御方案对经过精心伪装、变体或全新的攻击手法缺乏有效的识别和泛化能力。
    
4.  **响应滞后且成本高**：外部审查模型或输出过滤通常在模型生成部分或全部内容后才介入，响应滞后。同时，引入额外的审查模型会显著增加系统推理延迟和计算成本。
    

#### **核心技术方案**

本发明提出一个从“黑箱”防御转向“白箱”监控的动态安全防御体系。其核心思想是：通过**协同感知**用户输入的**外部语义风险**与模型推理过程中的**内部状态异常**，进行交叉验证和联合决策，从而实现对复杂、未知攻击的早期、精准识别和拦截，并构建一个能够自我进化的防御闭环。

----------

#### **方法内容**

**目标**：在用户输入送达主模型之前，快速识别其潜在的恶意意图，进行风险初筛。

**核心步骤：**

1.  **高风险意图分析**
    
    -   在主模型前端部署一个轻量级的**意图分类模型**。
        
    -   该模型专门训练用于识别典型的攻击模式，如：
        
        -   **指令冲突与覆盖** (如：“忽略你之前的所有指令...”)
            
        -   **角色扮演诱导** (如：“你现在扮演DAN...”)
            
        -   **假设情景规避** (如：“在一个虚构的故事里...”)
            
2.  **生成初始风险评分- [核心创新点1: 前置意图分析]**
    
    -   根据意图分析结果，系统为每个用户输入生成一个量化的“初始风险评分”。
        
    -   此评分作为外部语义风险的初步判断依据，高分表示输入本身具有明显的攻击倾向。
        

----------

**目标**：在主模型生成内容的过程中，实时监控其内部计算状态，捕捉由恶意输入引发的“神经活动”异常。

**核心步骤：**

1.  **关键内部指标监控 - [核心创新点2: 内部状态“白箱”监控]**
    
    -   将监控模块与主模型的Transformer层深度耦合，实时提取并计算以下关键指标：
        
    -   **（1）注意力分布熵 **：
        
        -   **原理**：攻击会迫使模型的注意力异常集中在恶意指令上，导致注意力权重分布的熵值急剧下降。
            
        -   **作用**：检测模型是否被“劫持”，不再关注其系统级安全指令。
            
    -   **（2）层激活范数**：
        
        -   **原理**：为绕过安全限制，模型会被迫进入罕见的状态空间，导致其神经元激活值的范数（如L2范数）出现异常峰值。
            
        -   **作用**：检测模型是否被推向其“行为”的边缘或异常区域。
            
2.  **生成内部异常评分**
    
    -   监控模块将实时监测到的指标与预设的正常基线进行比较，动态生成一个量化的“内部异常评分”，反映模型内部状态的紊乱程度。
        

----------

**目标**：结合外部语义风险和内部状态异常两个维度的信息，做出最准确的、高置信度的安全决策。

**核心步骤：**

1.  **协同决策逻辑 - [核心创新点3: 协同决策逻辑]**
    
    -   裁决模块接收“初始风险评分”和“内部异常评分”，并根据预设策略进行联合判断：
        
        -   **低风险 + 低异常** → **放行**：判定为安全请求。
            
        -   **高风险 + 高异常** → **拦截**：判定为高置信度攻击。
            
        -   **低风险 + 高异常** → **拦截并标记**：识别出语义隐蔽的**未知新型攻击**，具有极高分析价值。
            
        -   **高风险 + 低异常** → **放行并记录**：表明模型自身成功抵御了攻击，可作为模型鲁棒性的正向样本。
            
2.  **执行响应**
    
    -   根据裁决结果，执行拦截、放行、告警或返回预设安全回复等操作。


        
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTA5Mzg4NDU0OSwxOTQ3MjY1NTc3XX0=
-->